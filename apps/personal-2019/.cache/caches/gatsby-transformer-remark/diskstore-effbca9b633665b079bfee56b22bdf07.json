{"expireTime":9007200894403823000,"key":"transformer-remark-markdown-html-215395bccf2545fc6e8ca5ab568d499a-gatsby-remark-autolink-headersgatsby-remark-imagesgatsby-remark-copy-linked-filesgatsby-remark-prismjs-","val":"<p>V tomto tutorialu vám ukáži, jak nastavit profesionální vývojové prostřední s pomocí continuous deployment.</p>\n<p>Budeme používat React s pomocí předpřipraveného projektu <a href=\"https://create-react-app.dev/\">Create-react-app</a>, ale můžete tento postup aplikovat na jakýkoliv projekt spravovaný pomocí NPM. I když nepoužíváte NPM, můžete použít jiné scripty pro testy a build. Pro tento tutoriál nemůsíte umět React ani JavaScript. React jsem vybral protože poskytuje rychlý projekt s předpřipravenými testy.</p>\n<p>Před tím než začneme, potřebuje mít nainstalovaný:</p>\n<ul>\n<li><a href=\"https://nodejs.org/en/download/\">NodeJS</a> s NPM s <a href=\"https://git-scm.com/\">Git</a>,</li>\n<li>Musíte mít účet na <a href=\"https://github.com\">Github</a>, Travis <a href=\"https://travis-ci.org/\">Travis-ci.org</a> a <a href=\"https://www.heroku.com/\">Heroku</a>. Všechny účty jsou zdarma. Travis CI používá .org TLD pro git repozitáře, které jsou veřejně dostupné. .com TLD je pro privátní repozitáře. Pro tento tutoriál použijeme verzi s .org TLD</li>\n</ul>\n<h2 id=\"vytvoreni-projektu-v-reactu-s-create-react-app\" style=\"position:relative;\"><a href=\"#vytvoreni-projektu-v-reactu-s-create-react-app\" aria-label=\"vytvoreni projektu v reactu s create react app permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vytvoření projektu v Reactu s Create-React-App</h2>\n<p>Otevřete terminál ve své pracovní složce. Na mém počítači to je <code class=\"language-text\">~/sandbox/</code></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> ~/sandbox/</code></pre></div>\n<p>V tomto adresáři vytvoříme projekt v Reactu s pomocí NPX (nástroj z NPM), které je předinstalováno v NPM ve verzi 5.2 a výše.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npx create-react-app tutorial-cicd</code></pre></div>\n<p>Spustí se instalace předpřipraveného projektu. Až se vše nainstaluje, na konci logu uvidíte všechny příkazy, které je možné v aplikaci použít. My si zatím otevřeme nový adresář.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> tutorial-cicd</code></pre></div>\n<p>Nemusíme spouštět <code class=\"language-text\">npm install</code> jelikož <code class=\"language-text\">npx</code> už závislosti nainstaloval. Nyní můžeme aplikaci spustit</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> start</code></pre></div>\n<p>Nová záložka v prohlížeči se otevře na adrese <code class=\"language-text\">http://localhost:3000</code> a následující stránka se zobrazí</p>\n<p><img src=\"../images/blog/create-react-app.png\" alt=\"Create-react-app\"></p>\n<p>Dobrá zpráva je ta, že create-react-app již obsahuje sadu testů. Nemusíme tedy psát další. Pro zkoušku můžete spustit sadu testů pomocí</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token builtin class-name\">test</span></code></pre></div>\n<p>Budete vyzváni k spuštění testů s různými nastaveními. Nyní stačí zmáčknout tlačítko <code class=\"language-text\">a</code> abychom spustili všechny testy. Pouze jeden test by měl proběhnout. Test má název <code class=\"language-text\">renders learn react link</code>. Ten má za cíl zjistit, jestli se na stránce vykreslí odkaz, který můžete vidět na <code class=\"language-text\">http://localhost:3000</code>. Jelikož React odkaz vykreslí, test projde.</p>\n<p>Nyní máme připravený projekt.</p>\n<h2 id=\"vytvoreni-github-repozitare-a-jeho-propojeni-s-nasim-projektem\" style=\"position:relative;\"><a href=\"#vytvoreni-github-repozitare-a-jeho-propojeni-s-nasim-projektem\" aria-label=\"vytvoreni github repozitare a jeho propojeni s nasim projektem permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vytvoření Github repozitáře a jeho propojení s naším projektem</h2>\n<p>Pokud již máte vytvořen účet na Githubu, můžete pokračovat v tutorialu. Pokud ne, registrujte se prosím na <a href=\"https://github.com\">Github.com</a>. Po přihlášení, vytvoříme nový repozitář. Nový repozitář lze vytvořit na adrese <a href=\"https://github.com/new\">https://github.com/new</a>.</p>\n<p>Repozitář nazveme <code class=\"language-text\">tutorial-cicd</code> a nastavíme ho jako <code class=\"language-text\">Public</code> (Veřejný). Nyní máme vytvořený repozitář, ale je potřeba ho propojit s naším projektem. To uděláme pomocí následujících příkazů ve složce projektu.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> remote <span class=\"token function\">add</span> origin git@github.com:<span class=\"token operator\">&lt;</span>vas_github_username<span class=\"token operator\">></span>/tutorial-cicd.git\n<span class=\"token function\">git</span> push -u origin master</code></pre></div>\n<p>Poznámka: Vyměnte prosím <code class=\"language-text\">&lt;vas_github_username></code> v prvním příkazu za Váš username na Githubu. Tímto způsobem se připojujete k repozitáři pomocí SSH. Alternativou je propojení přes HTTPS</p>\n<p>Nemusíme prováděd příkazy jako <code class=\"language-text\">git init</code>, protože to NPX udělal již za nás. Také přidal soubor <code class=\"language-text\">.gitignore</code>.</p>\n<p>Jestli jste všechno udělali dle návodu, měli byste nyní vidět na Githubu pod tímto názvem Váš projekt.</p>\n<p>Nyní máme propojený Github a náš projekt.</p>\n<h2 id=\"propojeni-github-repozitare-s-travis-ci\" style=\"position:relative;\"><a href=\"#propojeni-github-repozitare-s-travis-ci\" aria-label=\"propojeni github repozitare s travis ci permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Propojeni Github repozitáře s Travis CI</h2>\n<p>Nyní přichází část, kde propojíme náš repozitář s Travis CI. Měli byste být přihlášení v Travis CI pod svým Github účtem, na kterém existuje projekt <code class=\"language-text\">tutorial-cicd</code>.</p>\n<p>Po úspěšném přihlášení klikněte na logo profilu v pravé horní části dashboardu. Klikněte na tlačítko <code class=\"language-text\">Nastavit</code> a potom na zelené tlačítko <code class=\"language-text\">Activate</code>. Poté byste měli vidět seznam veřejných repozitářů na vašem účtu Github. Pokud nevidíte repozitář <code class=\"language-text\">tutorial-cicd</code>, klikněte v levé části obrazovky na položku <code class=\"language-text\">Sync account</code>. K synchronizaci Github a Travis CI bude potřeba několik minut (nevím, proč synchronizace zabere tolik času). Po úspěšné synchronizaci byste měli vidět <code class=\"language-text\">tutorial-cicd</code> repozitář.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26a9ebb13f68581e7d8e8694009c0d84/1fbe8/success-travisci.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9UlEQVQoz5WRgW7EIAiG+xRtVUARvNnu0nv/txtqr7stuSVLvrS/kB8Bp9V5EI3bZ4hJVD3Q4vzign1XHy594s/4YLJDzMLllrVIKayai2bRprNkbbqhOrRoi7sA3ewDIBHFmNigmBomUgKKprFHYo/0VIs8zatDK3Y/6KOmuvN+l+OB5TavzurOvdv5avupv9tOWnTbpVbMEhIHzja/p+go+leQXAcS29GW1dpGZpuHtUBMi/VjALpfBGi1OJtGMyOdN7NI3fZaNxvsdZk/sItE4XgAoO3SAzbzyNmEbch3zoFlx/tdTzV+LgT3h+0N0/p/z8UXj3VC8eJEAN0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/26a9ebb13f68581e7d8e8694009c0d84/c54d4/success-travisci.webp 175w,\n/static/26a9ebb13f68581e7d8e8694009c0d84/a3432/success-travisci.webp 350w,\n/static/26a9ebb13f68581e7d8e8694009c0d84/426ac/success-travisci.webp 700w,\n/static/26a9ebb13f68581e7d8e8694009c0d84/4578a/success-travisci.webp 757w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/26a9ebb13f68581e7d8e8694009c0d84/4edbd/success-travisci.png 175w,\n/static/26a9ebb13f68581e7d8e8694009c0d84/13ae7/success-travisci.png 350w,\n/static/26a9ebb13f68581e7d8e8694009c0d84/8c557/success-travisci.png 700w,\n/static/26a9ebb13f68581e7d8e8694009c0d84/1fbe8/success-travisci.png 757w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/26a9ebb13f68581e7d8e8694009c0d84/8c557/success-travisci.png\"\n            alt=\"Success Travis CI\"\n            title=\"Success Travis CI\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Success Travis CI</figcaption>\n  </figure></p>\n<h2 id=\"vytvoreni-konfiguracniho-souboru-pro-travis\" style=\"position:relative;\"><a href=\"#vytvoreni-konfiguracniho-souboru-pro-travis\" aria-label=\"vytvoreni konfiguracniho souboru pro travis permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vytvoření konfiguračního souboru pro Travis</h2>\n<p>Abychom mohli specifikovat, co se má na straně Travis spustit, musíme vytvořit soubor <code class=\"language-text\">.travis.yml</code> v root adresáři našeho projektu.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">touch</span> .travis.yml</code></pre></div>\n<p>V tomto souboru specifikujeme programovací jazyk, který bude použit, jeho verzi a skripty.</p>\n<p>Protože budeme používat JavaScript na serveru, použijeme NodeJS ve verzi 12. Pro tento tutoriál spustíme pouze testy a produkční build create-react-app. Takže do .travis.yml přidáme</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js\n\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token string\">\"12\"</span>\n\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> npm test\n  <span class=\"token punctuation\">-</span> npm run build</code></pre></div>\n<p>Uložíme a pushneme do repozitáře na Githubu</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add travis.yml config file\"</span>\n<span class=\"token function\">git</span> push</code></pre></div>\n<p>Když navšívíte <code class=\"language-text\">tutorial-cicd</code> v Travisu na URL</p>\n<p><code class=\"language-text\">https://travis-ci.org/github/&lt;your-github-name>/tutorial-cicd</code></p>\n<p>Uvidíte buď probíhající build (žlutý), již dokončený (zelený) či ukončený s chybou (červený).</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9f83548746d9db0dd3d175078087bf52/ae21e/build-travisci.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.857142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAi0lEQVQY022OWQ7DIAxEuUXBC5jFkFb56P1PVydEKaoqPVmGkWfGJclNVXuvrekYUipHkXfxEX1AD+ecywIQIUcHWkjkICUgvuSAAWkCzMb9NDxQlJxrdbCXvm36HBTj1xuv5RFAamljnDdrMpMl4259uzn9yDdH+N1owXwdvqo1mPLabSmJfyX7/AA1OCEdtI/nngAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9f83548746d9db0dd3d175078087bf52/c54d4/build-travisci.webp 175w,\n/static/9f83548746d9db0dd3d175078087bf52/a3432/build-travisci.webp 350w,\n/static/9f83548746d9db0dd3d175078087bf52/426ac/build-travisci.webp 700w,\n/static/9f83548746d9db0dd3d175078087bf52/c139f/build-travisci.webp 1050w,\n/static/9f83548746d9db0dd3d175078087bf52/7f403/build-travisci.webp 1400w,\n/static/9f83548746d9db0dd3d175078087bf52/c3c33/build-travisci.webp 1537w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9f83548746d9db0dd3d175078087bf52/4edbd/build-travisci.png 175w,\n/static/9f83548746d9db0dd3d175078087bf52/13ae7/build-travisci.png 350w,\n/static/9f83548746d9db0dd3d175078087bf52/8c557/build-travisci.png 700w,\n/static/9f83548746d9db0dd3d175078087bf52/e996b/build-travisci.png 1050w,\n/static/9f83548746d9db0dd3d175078087bf52/2cefc/build-travisci.png 1400w,\n/static/9f83548746d9db0dd3d175078087bf52/ae21e/build-travisci.png 1537w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9f83548746d9db0dd3d175078087bf52/8c557/build-travisci.png\"\n            alt=\"Build Travis CI\"\n            title=\"Build Travis CI\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Build Travis CI</figcaption>\n  </figure></p>\n<p>Pod tímto boxem s informacemi je log celého buildu. Jestli se vyskytne během buildu nějaká chyba, zde uvidíte chybovou hlášku.</p>\n<p>Jestli vše proběhne jak má a build je zelený, tak jste práve spustili první automatizovaný build!</p>\n<h2 id=\"vytvoreni-projektu-na-heroku\" style=\"position:relative;\"><a href=\"#vytvoreni-projektu-na-heroku\" aria-label=\"vytvoreni projektu na heroku permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vytvoření projektu na Heroku</h2>\n<p>Abychom měli kde hostovat aplikaci, musíme si vytvořit projekt na Heroku, které umožňuje spouštět aplikace v cloudu. Pro vytvoření je potřeba účet na jejich <a href=\"https://heroku.com\">webových stránkách</a>. Po přihlášení vytvoříme novou aplikaci na <a href=\"https://dashboard.heroku.com/new-app\">této URL</a>. Pojmenujte aplikaci jako <code class=\"language-text\">&lt;vase-jmeno>-tutorial-cicd</code> a vyplňte region blíže k Vaší aktuální poloze. Pro mě je to <code class=\"language-text\">Europe</code>. Jestli je název aplikace již zabraný, změnte jeho prefix, ale nezapomeňte ho změnit i později. Klikněte na \"Create app\".</p>\n<h3 id=\"nastaveni-metodu-pro-deployment-jako-github\" style=\"position:relative;\"><a href=\"#nastaveni-metodu-pro-deployment-jako-github\" aria-label=\"nastaveni metodu pro deployment jako github permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nastavení metodu pro deployment jako Github</h3>\n<p>Pro propojení Heroku s Github repozitářem, v sekci \"Deployment method\", vyberte Github. Najděte Váš Github repozitář a připojte ho. V sekci \"Automatic deploys\" zaškrtněte \"Wait for CI to pass before deploy\" a poté klikněte na \"Enable Automatic Deploys\".</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/27e6970d02d1814b7b647361aadca69e/1628f/deployment-heroku.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDklEQVQoz3VRi5LDIAj0/7+0nTQP36CItzG5tL3JMeAMsrqwmMKVcsHZf02158hNdNvs4/lkKZmYuJTyxgCFMP3OamlNlYl89LUhaSKCqz8wI1VACxfRD3KgtUqX1kU6M1BnU7s3bTGhbJyL87zhJGIwDIRa6+fFPV55WrJ1admCCwzuwyv4rK/EN23jcUocI/nAKRERhpV94tqu9+hSmqLthp6RHS0NKRTViv9lj0FVLy1PxI7uxvu4LDZGKFqYC0pQxvrgXLDOb9ZbFzCVC2nzeaAKAo6PzaGk6lst3ISYDk8ZUmBVOzrmWg7dLrVvZ17XdZ6XaXrlTEjHngbL97rMqf73CsswTKGq/X/7Ad2YTIfaYdoCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/27e6970d02d1814b7b647361aadca69e/c54d4/deployment-heroku.webp 175w,\n/static/27e6970d02d1814b7b647361aadca69e/a3432/deployment-heroku.webp 350w,\n/static/27e6970d02d1814b7b647361aadca69e/426ac/deployment-heroku.webp 700w,\n/static/27e6970d02d1814b7b647361aadca69e/c139f/deployment-heroku.webp 1050w,\n/static/27e6970d02d1814b7b647361aadca69e/46ece/deployment-heroku.webp 1232w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/27e6970d02d1814b7b647361aadca69e/4edbd/deployment-heroku.png 175w,\n/static/27e6970d02d1814b7b647361aadca69e/13ae7/deployment-heroku.png 350w,\n/static/27e6970d02d1814b7b647361aadca69e/8c557/deployment-heroku.png 700w,\n/static/27e6970d02d1814b7b647361aadca69e/e996b/deployment-heroku.png 1050w,\n/static/27e6970d02d1814b7b647361aadca69e/1628f/deployment-heroku.png 1232w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/27e6970d02d1814b7b647361aadca69e/8c557/deployment-heroku.png\"\n            alt=\"Heroku Success Deployment Method\"\n            title=\"Heroku Success Deployment Method\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Heroku Success Deployment Method</figcaption>\n  </figure></p>\n<h2 id=\"propojeni-travis-a-heroku\" style=\"position:relative;\"><a href=\"#propojeni-travis-a-heroku\" aria-label=\"propojeni travis a heroku permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Propojení Travis a Heroku</h2>\n<p>Propojení Travis a Heroku spočívá v upravení našeho <code class=\"language-text\">.travis.yml</code> souboru. Před úpravou musíme vytvořit api klíč. Pro vytvoření je nutné mít nainstalovaný <a href=\"https://devcenter.heroku.com/articles/heroku-cli\">Heroku</a> a <a href=\"https://github.com/travis-ci/travis.rb#readme\">Travis</a> CLI. Po instalaci se přihlašte přes terminál do Heroku pomocí</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">heroku login</code></pre></div>\n<p>To vás vyzve k vyplnění e-mailu a hesla pro Heroku.</p>\n<p>Po úspěšném přihlášení spusťte</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">travis encrypt <span class=\"token variable\"><span class=\"token variable\">$(</span>heroku auth:token<span class=\"token variable\">)</span></span> --add deploy.api_key</code></pre></div>\n<p>Potvrdíte detekovaný repozitář vypsáním <code class=\"language-text\">yes</code> do terminálu a potvrzením. Poté se vás CLI zeptá, zda chcete přepsat Travis configurační soubor s částí pro deploy. Potvrďte vepsáním <code class=\"language-text\">y</code>. Otevře si <code class=\"language-text\">.travis.yml</code> a vypíšeme providera deploye a název aplikace. Soubor by výsledně měl vypadat takto</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js\n\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token string\">\"12\"</span>\n\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> npm test\n  <span class=\"token punctuation\">-</span> npm run build\n\n<span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span> heroku\n  <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> &lt;your_heroku_app_name<span class=\"token punctuation\">></span>\n  <span class=\"token key atrule\">api_key</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">secure</span><span class=\"token punctuation\">:</span> &lt;your_secure_key<span class=\"token punctuation\">></span></code></pre></div>\n<p>Nyní můžeme pushnout změnu do repozitáře</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add deploy section to travis.yml\"</span>\n<span class=\"token function\">git</span> push</code></pre></div>\n<h2 id=\"spusteni-statickych-souboru-na-heroku\" style=\"position:relative;\"><a href=\"#spusteni-statickych-souboru-na-heroku\" aria-label=\"spusteni statickych souboru na heroku permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spuštění statických souborů na Heroku</h2>\n<p>Jelikož vytvoříme produkční build create-react-app, musíme specifikovat jak se má projekt spustit. Pro tuto část využijeme balíček <code class=\"language-text\">serve</code> z NPM. Jsou zde lepší alternativy pro spuštění serveru, ale tento je nejvíce přímočarý pro tutorial. Musíte tedy nainstalovat další závislost do projektu</p>\n<p>V terminálu spustíme</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save serve</code></pre></div>\n<p>Poté změníme náš <code class=\"language-text\">start</code> skript v <code class=\"language-text\">package.json</code> aby používal práve nainstalovaný <code class=\"language-text\">serve</code> balíček.</p>\n<p>Poznámka: změnte pouzte řádek <code class=\"language-text\">start</code> v objektu <code class=\"language-text\">scripts</code>. Vše ostatní nechte beze změny.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    ...\n    <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"serve -s build\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"react-scripts build\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"react-scripts test\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"eject\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"react-scripts eject\"</span>\n    <span class=\"token punctuation\">}</span>\n    ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Můžeme opět commitnou a pushnout změny</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add serve package\"</span>\n<span class=\"token function\">git</span> push</code></pre></div>\n<p>Po bezchybném dokončení buildu v Travis bychom měli vidět naší aplikaci běžet na adrese</p>\n<p><code class=\"language-text\">https://&lt;your_heroku_app_name>.herokuapp.com/</code></p>\n<h2 id=\"zaver\" style=\"position:relative;\"><a href=\"#zaver\" aria-label=\"zaver permalink\" class=\"Blog-share before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Závěr</h2>\n<p>Právě jste nastavili continuous deployment, který nasadí změny přímo do produkce bez nutného zásahu lidské ruky. Jenom chyba v testech či v buildu zapříčiní zastavení nasazení. Pamatujte, že byste měli vždy vytvořit novou Git větev při vytvoření nových feature aby Vám někdo mohl udělat Code review před nasazením do produkce.</p>\n<p>Můj repozitář může být nalezen na <a href=\"https://github.com/michalhonc/tutorial-cicd\">zde</a>.</p>"}